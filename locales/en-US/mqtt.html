<!--
  Copyright JS Foundation and other contributors, http://js.foundation
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
  http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-help-name="digitaloak-mqtt-in">
<p>Connects to a MQTT broker and subscribes to messages from the specified topic.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
	<dt>topic <span class="property-type">string</span></dt>
	<dd>Topic to subscribe to</dd>
	<dt>payload <span class="property-type">string</span></dt>
	<dd>If passed string value in format <b>_unsubscribe:nodeName</b> (i.e. _unsubscribe:waitingForServiceResponse) along with defined <b>msg.topic</b> property, all nodes with the specified name will be unsubscribed from the given topic. Node will not pass any msg according to this action.
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
       <dt>payload <span class="property-type">string | buffer</span></dt>
       <dd>a string unless detected as a binary buffer.</dd>
       <dt>topic <span class="property-type">string</span></dt>
       <dd>the MQTT topic, uses / as a hierarchy separator.</dd>
       <dt>qos <span class="property-type">number</span> </dt>
       <dd>0, fire and forget - 1, at least once - 2, once and once only.</dd>
       <dt>retain <span class="property-type">boolean</span></dt>
       <dd>true indicates the message was retained and may be old.</dd>
    </dl>
    <h3>Details</h3>
    The subscription topic can include MQTT wildcards, + for one level, # for multiple levels.</p>
    <p>This node requires a connection to a MQTT broker to be configured. This is configured by clicking
    the pencil icon.</p>
    <p>Several MQTT nodes (in or out) can share the same broker connection if required.</p>
    <p>When msg.topic is not set, msg will be passed through node.</p>
    <p>Set "Usubscribe from topic after first msg received" in config node if you want to automatically unsubscribe from topic after receiving a msg</p>
</script>
